<!DOCTYPE html>
<html>
    <head>
        <title>Sync Browser Time - Example Client</title>

        <script type="text/javascript" src="./tacitact/tacitact.min.js" defer></script>
        <script type="text/javascript">
            function main () {
                const tc = new tacitact.Client(window.location.href, { debug: true })
                tc.connected((socket) => {
                    console.log('[client-web] tacitact connected via socket', socket.id)
                })
                console.log(tc.getTime())

                const browserTimeEl = document.getElementById('browser-time')
                const syncedTimeEl = document.getElementById('synced-time')
                const currentOffsetEl = document.getElementById('current-offset')

                tc.startSync(10000)

                browserTimeEl.innerText = Date.now()
                syncedTimeEl.innerText = 'syncing ...'
                currentOffsetEl.innerText = 'syncing ...'

                tc.synced(() => {
                    console.log('[client-web] first sync successful')
                    setInterval(() => {
                        browserTimeEl.innerText = Date.now()
                        syncedTimeEl.innerText = tc.getTime()
                        currentOffsetEl.innerText = tc.getOffset()
                    }, 1000)
                })

            }

            window.onload = main
        </script>
        <style>
            .hint {
                border-left: 4px solid #f9c;
                padding: 4px 8px;
            }

            table {
                border: 0;
                border-collapse: collapse;
            }

            table > * {
                text-align: left;
                padding: 4px;
            }
            
            table th {
                padding-right: 16px;
            }
        </style>
    </head>


    <body>
        <p class="hint">Don't forget start one of the webservers to have the client js served!</p>
        <div>
            <table>
                <tr>
                    <th>Browser Time</th>
                    <td id="browser-time"></td>
                </tr>
                <tr>
                    <th>Synced Time</th>
                    <td id="synced-time"></td>
                </tr>
                <tr>
                    <th>Current Offset</th>
                    <td id="current-offset"></td>
                </tr>
            </table>
        </div>
    </body>
</html>
